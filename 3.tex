% 寫資料集
% 最後！處理數據作圖…！！ 是要多久……啊就那樣

\chapter{單一語音離散表徵與音位的關係}  % 與語音標記的對應模式
　　
由於 HuBERT 和 wav2vec 2.0 等語音基石模型的成功，不但在語音任務上達到了前所未有的表現，還促使從語音表徵離散化的想法得以發展。以此產生的「無文字（Textless）」架構，讓人們在處理語音訊號時，有了連續表徵以外的新選擇。
離散形式的表徵，可以直接應用文字領域發展的技術，如機器翻譯、生成式模型等，為語音技術帶來新的突破。
另一方面，基於離散「符記（token）」的共同形式，離散語音表徵可以更好的整合文字資料，促成多模態領域的發展。跨模態離散表徵的成功，甚至驅使影像領域也開始嘗試發展離散表徵，如探討唇語的 AV-HuBERT \cite{shi2021learning} 等等，展現了離散表徵在資料處理上的優勢。  % 不是模型運算
% 還有影像的 vokenization \cite{tan-bansal-2020-vokenization} 等等。好像更早
% TODO: 找到影像那邊的新的 token?

% 語言學那邊只有一般語音？還是包含 acoustic phon 嗎？
此外，除了技術的角度切入，為了探討離散語音表徵成功背後的可能因素，
以及它們和語言學對人類語音理解之間的差異，甚至是進而得以利用這些技術協助他們更細緻的探討人類的語音現象。因此，原先在連續語音表徵上的語音學分析，也開始關注離散表徵背後有多能描述對語音現象，將其列入考量，成為除了連續語音特徵和時頻譜之外的另一個選擇。
% TODO: cite  "is cont necessary? 那篇"
% 更由於這些離散表徵形式上和音位、文字的相似性，  %% 這個好像還沒？
%% 他們還是更喜歡 IPA，只是先當成一種新的 label 吧？

\section{相關研究}

\subsection{無文字與離散語音表徵}
　　
自從 HuBERT 帶起來的研究之後，
愈來愈多離散表徵相關的研究，
例如 \mycite{這邊要 cite 一些東西} 等等。
它們在提出自己的離散表徵時，
也會採用原先 HuBERT 提供的那些衡量方式，
% 例如 PNMI 等等的，
來驗證這些離散單元確實是與語音中的內容
與人類對語音的詮釋
具有一定程度的相關性，
並從消息理論的角度，
證明這些偽標記找出來的符號之間，
確實可以做到區分語音中不同形式的資訊。

\subsection{語音學分析}
　　
另一個層面，
由於語音處理本身所針對與探討的
終究是人類的語音。
因此，
有一群研究者通過對人類語音本身的理解，
將這些知識應用在分析模型如何對語音訊號建構表徵之上。
例如  \mycite{這邊要 cite 那些如唐顥等分析語音本身的} 等。
% 就韋誠說的妹子那篇嗎？

基於這些作品都對語音的離散表徵
感到興趣而做出的探討，
本論文也先透過
過往幾個常用來
分析語音表徵的
方式，
特別是
HuBERT 原始 paper 中提出的標準
進行初步的分析。
以下介紹此次分析語音表徵的
衡量方式：

\section{衡量方式}

　　
首先是純度（Purity）、熵（Entropy）和相互資訊（Mutual Information，MI），
這類標準是在原始 HuBERT 論文中採用的指標 \cite{hsu_hubert_2021, hsu_hubert_2021-2}，
在比對機器學習過程得到的偽標記與人類知識的標註之間，兩者的相關性（Correlation）。
以下對各標準進行詳細解釋：


不論是什麼
語音基石模型，
語音表徵的基本單位是音框（Frame）
。
因此一段語句（Utterance）的語音的離散單元被表示為
$$[y_1, \cdots\cdots, y_T]$$
其中 $T$ 是該段語句的音框總數。
對於該段語句，若給予一段
在音框上對齊的
語音學標註（Phonetic Label）
$$[z_1, \cdots\cdots, z_T]$$
，此時我們可以將離散單元與標註之間配對的出現次數，寫為一個雙變數的共同分佈（Joint Distribution）

$$
p_{yz} = 
\frac{
\sum^T_{t=1}
[
{y_t = i 
\wedge
z_t = j}
]
}
{T}$$

其中 $i$ 是第 $i$ 個音位類別，而 $j$ 指編號為$j$的離散單元。
兩個變數的邊際機率（Marginal Probability）為
$$p_z(j)=\sum_i{p_{yz}(i, j)}$$
和
$$p_y(i)=\sum_j{p_{yz}(i, j)}$$

因此，對於每一個音位 $i$ 而言，這個音位對應最可能的離散單元為
 $$z^\ast(i) = \arg\max_j p_{yz}(i, j)$$
與之相對應的，對於每一個離散單元的類別 $j$ 則可以找到機率最高的音位
$$y^\ast(j) = \arg\max_i p_{yz}(i,j)$$

於是我們可以計算出以下指標：

\subsection{純度}

本指標考慮音位和離散單元兩個序列之間對應的最高機率，因此從音位與離散單元的角度出發，可以得到以下兩項數據：


%% 這邊抄 HUBERT paper
\paragraph{
音位純度（Phoneme Purity）：}
考慮每個離散單元對應的音位中，最高機率音位的機率，表示為

% phoneme purity: 每個cluster unit內的phoneme purity，代表此unit是否有phoneme代表性

% Expectation symbol
\newcommand{\E}{\mathbb{E}}

$$\E_{p_z(j)}\left[p_{y|z}(y^*(j)|j) \right]$$

此指標表示該單元是否對與它對應的音位有足夠的代表性。

\paragraph{
分群純度（Cluster Purity）：}
與音位純度相對，改以每個音位的角度，考慮對應單元類別的機率

$$\E_{p_y(i)}\left[p_{z|y}(z^*(i)|i) \right]$$

由於離散表徵進行分群演算法時
的類別數是
一項超參數（Hyperparameter），
且通常離散單元的分群數量會比音位多，
因此
該
統計
數據
本身
不直接具有
語音學的解釋意義，
而且在
% 這項指標在
分群數量很多時
會顯著下降。

然而該指標在考量
音位
純度時必須一併考慮，
因為當分群數非常多時，
分群純度過低可能使得音位純度相較失去意義。
一個極端的情形是每一個音框都給予不同的離散單元編號，
如此音位純度可以達到 100\%
。
但如此一來，離散單元做不到歸納音位類別的目的，
音位純度也就失去了意義。



% cluster purity：每個phoneme對應到的cluster統計，若cluster purity低代表less liguistical meaning?單一 phoneme 本身對應的 unit 的一致性。如果


\subsection{熵和相互資訊}
　　
除了純度提供「最高機率」的對應關係，根據 HuBERT 論文 \cite{hsu_hubert_2021-2} 中的分析方式，我們也可以從資訊理論（Information Theory）的角度，觀察兩個序列的熵和相互資訊。

\paragraph{熵}

熵的定義按照資訊理論，衡量兩個序列中標籤類別出現機率的不確定性（Uncertainty），公式寫作：

\begin{align}
    H(y) = \sum_i{p_y(i)\log p_y(i)}
    H(z) = \sum_j{p_z(j)\log p_z(j)}
\end{align}

$H(y)$ 和 $H(z)$ 分別為音位和離散單元的熵。

\paragraph{以音位標準化之相互資訊（Phone-normalized Mutual Information，PNMI）}

本數據以「觀察到某一個離散單元，能降低多少音位標註的不確定性」，定義該離散單元的出現背後提供了多少音位的資訊。公式寫為：
\begin{align}
\frac{I(y;z)}{H(y)}&=\cfrac{\sum_i \sum_j p_{yz}(i, j) \log \cfrac{p_{yz}(i, j)}{p_y(i)p_z(j)}}{\sum_i p_y(i) \log p_y(i)} \\
&=\frac{H(y)-H(y|z)}{H(y)} \\
&=1-\frac{H(y|z)}{H(y)}
\end{align}

該項數據愈高，表示離散單元的分群愈是足以提供語音音位的資訊，是一個品質更好的分群結果。
由於離散單元能多好的對應到音位才是人們所關心的問題，因此與純度不同，只以音位的角度出發，而不考慮以離散單元分群的角度。


\input{0}

% 第二塊 %%%%%%%%%%%%%%%%%%

% 第一塊 %%%%%%%%%%%%%%%%%%
%%%%%% \subsection{基於各自音位的分析}

%%%%%%%%% (放數據)



% 第一塊後半 %%%%%%%%%%%%%%%%%%









% 後面寫 arpabet?

% 調音部位 →    唇   舌冠  舌背  咽喉
% 調音方法 ↓    雙唇  唇齒  舌唇  齒   齒齦  齦後  捲舌  齦腭  硬腭  軟腭  小舌  咽   會⁠厭 聲門
% 鼻音    m̥  m       ɱ       n̼          n̥  n           ɳ̊  ɳ           ɲ̊  ɲ   ŋ̊  ŋ       ɴ                       
% 塞音    p   b   p̪  b̪  t̼  d̼          t   d           ʈ   ɖ           c   ɟ   k   ɡ   q   ɢ           ʡ       ʔ   
% 有噝擦音                                  s   z   ʃ   ʒ   ʂ   ʐ   ɕ   ʑ                                               
% 無噝擦音  ɸ   β   f   v   θ̼  ð̼  θ   ð   θ̠  ð̠  ɹ̠̊˔    ɹ̠˔     ɻ˔          ç   ʝ   x   ɣ   χ   ʁ   ħ   ʕ   ʜ   ʢ   h   ɦ
% 近音            ʋ̥  ʋ                   ɹ̥  ɹ           ɻ̊  ɻ           j̊  j   ɰ̊  ɰ                               ʔ̞
% 閃音        ⱱ̟      ⱱ       ɾ̼          ɾ̥  ɾ           ɽ̊  ɽ                               ɢ̆              ʡ̆      
% 顫音    ʙ̥  ʙ                           r̥  r           ɽ̊r̥    ɽr                          ʀ̥  ʀ                       
% 邊擦音                                   ɬ   ɮ           ɭ̊˔ ɭ˔          ʎ̝̊ ʎ̝  ʟ̝̊ ʟ̝                              
% 邊近音                                   l̥  l           ɭ̊  ɭ           ʎ̥  ʎ   ʟ̥  ʟ       ʟ̠                      
% 邊閃音                                       ɺ               ɭ̆              ʎ̆      ʟ̆                              
% 國際音標說明國際音標表模板







%%%% BETTER Have Todo！有機率看哪裡說一下 HuBERT……
%%%% BETTER Have Todo！有機率看哪裡說一下 HuBERT……
%%%% BETTER Have Todo！有機率看哪裡說一下 HuBERT……



%%%%%% \section{語音學分類（phone type）}
%%%%%% 
%%%%%% \subsection{簡介}
%%%%%% 
%%%%%% 除了單一 phn 本身的特性以外，由於 phn 本身彼此不是完全獨立的，而是彼此之間就存在相似的特徵，可以分成幾個組別。因此，依照 CITEME (tanghao等三篇) 的分組方式，對英語的 phn 進行分類並合併比對數據，看看這些 unit 本身是否有 capture 到相似的發聲特徵，而不單純只是把 phn 分成約五十類完全獨立的標籤。
%%%%%% 
%%%%%% % （基於語音表徵本身就是 acoustic sisgnals 來的，應該 by nature 要可以對語音特徵分組吧？）
%%%%%% 
%%%%%% % 以下為各分組進行簡單介紹：
%%%%%% 
%%%%%% % \subsubsection{consonants}
%%%%%% 
%%%%%% 按照發音的方式，子音可分為五類：
%%%%%% 
%%%%%% \begin{itemize}
%%%%%%     \item （Plosive）
%%%%%%     \item 擦音（Fricative）
%%%%%%     \item 塞擦音（Affircate）
%%%%%%     \item 鼻音（Nasal）
%%%%%%     \item 近音（Approximant）
%%%%%% \end{itemize}
%%%%%% 
%%%%%% % \subsubsection{vowels}
%%%%%% 
%%%%%% 母音則是被分為：
%%%%%% 
%%%%%% \begin{itemize}
%%%%%%     \item 單原因
%%%%%%     \item 雙原因
%%%%%% \end{itemize}
%%%%%% 
%%%%%% % 母音在這邊為了簡單起見，會被分在一起？
%%%%%% 
%%%%%% \subsection{解釋意義}
%%%%%% 
%%%%%% \begin{itemize}
%%%%%%     \item 純度（purity）：換成type之後有何變化（關聯性更強？）
%%%%%%     \item 熵（entropy）（放直方圖解釋） --> phone type更明顯？
%%%%%%     \item 對齊（alignment）：是否減少segment資訊的保留（連續子音母音被合併？
%%%%%% \end{itemize}



%%%%%% 
%%%%%% \subsection{基於語音學分類的分析}
%%%%%% 
%%%%%% (放數據)

%%%%%%%%%%%%%%%%%% \subsection{以語音分段指標衡量對齊（Alignment）程度}
%%%%%%%%%%%%%%%%%% 　　
%%%%%%%%%%%%%%%%%% 為了分析離散單元跟音位在語句序列之間的對齊程度，
%%%%%%%%%%%%%%%%%% 本研究根據 \cite{strgar_phoneme_2023} 的方法
%%%%%%%%%%%%%%%%%% 採用語音分段（Speech Segmentation）的標準去衡量。
%%%%%%%%%%%%%%%%%% 具體動機為將被分到同一個離散單元編號的音框當成語音分段的同一類別的音位，
%%%%%%%%%%%%%%%%%% 以此
%%%%%%%%%%%%%%%%%% 期望可以
%%%%%%%%%%%%%%%%%% 觀察出
%%%%%%%%%%%%%%%%%% 在每一段語句中，
%%%%%%%%%%%%%%%%%% 離散單元出現的順序與範圍，
%%%%%%%%%%%%%%%%%% 與音位標註指示的範圍一致的程度。
%%%%%%%%%%%%%%%%%% 
%%%%%%%%%%%%%%%%%% ％％　ａｌｉｇｎｍｅｎｔ

% 看 alignment 並 cite 那邊，說明一下
% 寫子母音

%%%%%%%%% 糟糕，沒講 HuBERT 但隨便
